<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#1a1a1e">
<title>Guitar Practice Tools</title>
<style>
:root{--bg:#1a1a1e;--sf:#242428;--sf2:#2e2e34;--tx:#e8e6e3;--txd:#8a8a8e;--fw:#b8a89a;--nut:#f5f0e8;--root:#e63946;--m2:#f4a261;--M2:#f4a261;--m3:#2a9d8f;--M3:#2a9d8f;--P4:#457b9d;--TT:#9b5de5;--P5:#e9c46a;--m6:#f77f00;--M6:#f77f00;--m7:#06d6a0;--M7:#06d6a0}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--tx);font-family:-apple-system,BlinkMacSystemFont,'Hiragino Sans','Hiragino Kaku Gothic ProN',Meiryo,sans-serif;min-height:100vh;min-height:-webkit-fill-available;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent;overscroll-behavior:none}
.app{max-width:1440px;margin:0 auto;padding:24px 32px}
header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:14px}
.logo{display:flex;align-items:center;gap:10px}
.logo i{width:36px;height:36px;background:linear-gradient(135deg,var(--root),#ff6b7a);border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;color:#fff;font-style:normal;box-shadow:0 3px 12px rgba(230,57,70,.3)}
h1{font-size:1.15rem;font-weight:700;letter-spacing:-.3px}h1 em{color:var(--txd);font-weight:400;font-size:.78rem;margin-left:6px;font-style:normal}
.ctrls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.cg{display:flex;flex-direction:column;gap:3px}
.cg label{font-size:.62rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--txd)}
select{background:var(--sf2);color:var(--tx);border:1px solid rgba(255,255,255,.08);border-radius:8px;padding:8px 28px 8px 10px;font-size:14px;cursor:pointer;appearance:none;-webkit-appearance:none;font-family:inherit;min-width:120px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 5 5-5' stroke='%238a8a8e' stroke-width='1.5' fill='none'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 8px center;transition:border-color .2s}
select:focus{outline:none;border-color:var(--root);box-shadow:0 0 0 3px rgba(230,57,70,.15)}
.tabs{display:flex;gap:4px;margin-bottom:16px;border-bottom:1px solid rgba(255,255,255,.06);padding-bottom:8px;overflow-x:auto}
.tab{background:none;border:none;color:var(--txd);font-family:inherit;font-size:.82rem;padding:8px 16px;cursor:pointer;border-radius:8px 8px 0 0;transition:all .2s;-webkit-tap-highlight-color:transparent;white-space:nowrap}
.tab:hover{color:var(--tx);background:var(--sf2)}.tab.on{color:var(--root);background:rgba(230,57,70,.1);border-bottom:2px solid var(--root)}
.tp{display:none}.tp.on{display:block}
.fbw{background:var(--sf);border-radius:14px;padding:20px 12px 12px;overflow-x:auto;-webkit-overflow-scrolling:touch;box-shadow:0 6px 24px rgba(0,0,0,.4);border:1px solid rgba(255,255,255,.04)}
.fn{display:flex;margin-bottom:3px;user-select:none}.fn:last-of-type{margin-bottom:0;margin-top:3px}
.fn .sp{width:44px;min-width:44px}.fn span{width:56px;min-width:56px;text-align:center;font-size:.65rem;color:var(--txd);position:relative}
.fn span.hd::after,.fn span.ht::before{content:'‚óè ‚óè';display:block;font-size:.3rem;color:rgba(255,255,255,.2);letter-spacing:2px}.fn span.hd::after{margin-top:-1px}.fn span.ht::before{margin-bottom:-1px}
.fn span.hs::after,.fn span.st::before{content:'‚óè';display:block;font-size:.3rem;color:rgba(255,255,255,.2)}.fn span.hs::after{margin-top:-1px}.fn span.st::before{margin-bottom:-1px}
.fb{position:relative;background:linear-gradient(180deg,#3d2114,#2c1810 30%,#241209 70%,#1e0f08);border-radius:7px;padding:10px 0;overflow:visible}
.dm{display:flex;height:0;position:relative;pointer-events:none}.dm .sp{width:44px;min-width:44px}.dm .dc{width:56px;min-width:56px;position:relative;height:0}
.dm .dc .d{position:absolute;width:11px;height:11px;border-radius:50%;background:radial-gradient(circle at 40% 35%,rgba(255,255,250,.2),rgba(180,175,165,.08));box-shadow:inset 0 1px 2px rgba(255,255,255,.1);left:50%;transform:translateX(-50%);border:1px solid rgba(255,255,255,.05)}
.sr{display:flex;align-items:center;height:38px;position:relative;min-width:fit-content}
.sl{width:44px;min-width:44px;text-align:center;font-size:.68rem;font-weight:600;color:var(--txd);z-index:2}
.sn{position:absolute;left:44px;right:0;top:50%;transform:translateY(-50%);z-index:0;pointer-events:none}
.fc{width:56px;min-width:56px;height:38px;position:relative;display:flex;align-items:center;justify-content:center}
.fc.nut::after{content:'';position:absolute;right:0;top:0;bottom:0;width:4px;background:var(--nut);border-radius:1px;box-shadow:2px 0 5px rgba(0,0,0,.4);z-index:1}
.fc:not(.nut)::after{content:'';position:absolute;right:0;top:0;bottom:0;width:2px;background:linear-gradient(180deg,rgba(200,185,170,.35),var(--fw),rgba(200,185,170,.35));z-index:1}
.nd{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.6rem;font-weight:700;z-index:3;position:relative;transition:transform .2s cubic-bezier(.34,1.56,.64,1),filter .2s;cursor:pointer;text-shadow:0 1px 2px rgba(0,0,0,.3);box-shadow:0 2px 6px rgba(0,0,0,.35),inset 0 1px 0 rgba(255,255,255,.2);animation:pop .3s cubic-bezier(.34,1.56,.64,1) backwards;line-height:1;-webkit-tap-highlight-color:transparent;touch-action:manipulation;user-select:none}
.nd:hover{transform:scale(1.2);z-index:10}
.nd.pl{transform:scale(1.3);filter:brightness(1.3);box-shadow:0 0 14px 3px currentColor,0 2px 6px rgba(0,0,0,.35)}
@keyframes pop{from{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}
.nd.root{background:var(--root);color:#fff;width:31px;height:31px;font-size:.65rem}
.nd.m2{background:var(--m2);color:#1a1a1e}.nd.M2{background:var(--M2);color:#1a1a1e}.nd.m3{background:var(--m3);color:#fff}.nd.M3{background:var(--M3);color:#fff}
.nd.P4{background:var(--P4);color:#fff}.nd.TT{background:var(--TT);color:#fff}.nd.P5{background:var(--P5);color:#1a1a1e}
.nd.m6{background:var(--m6);color:#1a1a1e}.nd.M6{background:var(--M6);color:#1a1a1e}.nd.m7{background:var(--m7);color:#1a1a1e}.nd.M7{background:var(--M7);color:#1a1a1e}
.nd.cmp{border-radius:4px;transform:rotate(45deg);opacity:.85}.nd.cmp span{transform:rotate(-45deg);display:block}
.nd.olap{box-shadow:0 0 0 3px rgba(255,255,255,.5),0 2px 6px rgba(0,0,0,.35)}
.lg{margin-top:14px;display:flex;gap:5px;flex-wrap:wrap;justify-content:center}
.li{display:flex;align-items:center;gap:5px;background:var(--sf2);padding:4px 9px;border-radius:16px;font-size:.65rem;border:1px solid rgba(255,255,255,.04)}
.ls{width:12px;height:12px;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.3)}
.pbc{display:flex;align-items:center;gap:10px;margin:12px 0;flex-wrap:wrap;justify-content:center}
.pbtn{background:var(--root);color:#fff;border:none;border-radius:50%;width:42px;height:42px;font-size:1.1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 3px 12px rgba(230,57,70,.3);transition:transform .15s;-webkit-tap-highlight-color:transparent}.pbtn:hover{transform:scale(1.1)}.pbtn:active{transform:scale(.95)}.pbtn.pg{background:var(--txd)}
.tc{display:flex;align-items:center;gap:6px;font-size:.72rem;color:var(--txd)}
.ts{-webkit-appearance:none;width:100px;height:4px;background:var(--sf2);border-radius:2px;outline:none}.ts::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:var(--tx);box-shadow:0 1px 4px rgba(0,0,0,.4)}
.db{background:var(--sf2);color:var(--txd);border:1px solid rgba(255,255,255,.08);border-radius:8px;padding:6px 10px;font-family:inherit;font-size:.72rem;cursor:pointer;-webkit-tap-highlight-color:transparent;transition:all .2s}.db.on{background:rgba(230,57,70,.15);border-color:var(--root);color:var(--root)}
.vc{display:flex;align-items:center;gap:5px}
.vs{-webkit-appearance:none;width:70px;height:4px;background:var(--sf2);border-radius:2px;outline:none;cursor:pointer}.vs::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:var(--tx);box-shadow:0 1px 4px rgba(0,0,0,.4)}
.clg{display:flex;gap:12px;justify-content:center;margin:8px 0;font-size:.72rem;color:var(--txd)}.clg .ci{display:flex;align-items:center;gap:5px}
.tra{text-align:center;padding:20px 0}
.trq{font-size:1.5rem;font-weight:700;margin:16px 0;min-height:60px;display:flex;align-items:center;justify-content:center;gap:16px}
.trn{width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.1rem;font-weight:700;color:#fff;box-shadow:0 3px 12px rgba(0,0,0,.3)}
.tro{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin:16px 0}
.trb{background:var(--sf2);color:var(--tx);border:2px solid rgba(255,255,255,.08);border-radius:10px;padding:10px 16px;font-family:inherit;font-size:.82rem;cursor:pointer;transition:all .2s;min-width:80px;-webkit-tap-highlight-color:transparent;touch-action:manipulation}
.trb:hover{border-color:rgba(255,255,255,.2);background:var(--sf)}.trb.ok{border-color:#06d6a0;background:rgba(6,214,160,.15);color:#06d6a0}.trb.ng{border-color:var(--root);background:rgba(230,57,70,.15);color:var(--root)}
.trs{font-size:.82rem;color:var(--txd);margin-top:12px}.trs strong{color:var(--tx);font-size:1rem}
.trfb{font-size:1.2rem;margin:8px 0;min-height:32px}
.trnx{background:var(--root);color:#fff;border:none;border-radius:8px;padding:10px 24px;font-family:inherit;font-size:.85rem;cursor:pointer;margin-top:12px;-webkit-tap-highlight-color:transparent}
.trli{background:var(--P4);color:#fff;border:none;border-radius:50%;width:36px;height:36px;font-size:1rem;cursor:pointer;-webkit-tap-highlight-color:transparent;box-shadow:0 2px 8px rgba(69,123,157,.3)}
.site-nav{display:flex;gap:4px;padding:10px 16px;max-width:1440px;margin:0 auto}
.nav-link{color:var(--txd);text-decoration:none;font-family:inherit;font-size:.75rem;padding:6px 14px;border-radius:8px;background:var(--sf2);border:1px solid rgba(255,255,255,.04);transition:all .2s;-webkit-tap-highlight-color:transparent}
.nav-link:hover{color:var(--tx);border-color:rgba(255,255,255,.12)}.nav-link.active{color:#e63946;background:rgba(230,57,70,.1);border-color:#e63946}
@media(max-width:768px){.app{padding:12px;padding-top:env(safe-area-inset-top,12px)}header{flex-direction:column;align-items:stretch;gap:10px;margin-bottom:14px}.logo{justify-content:center}h1{font-size:1rem}h1 em{display:none}.ctrls{width:100%;display:grid;grid-template-columns:1fr 1fr;gap:7px}.cg label{font-size:.55rem}select{min-width:0;width:100%;padding:10px 26px 10px 8px;font-size:16px;border-radius:10px}.fbw{padding:10px 6px 6px;border-radius:10px}.fn .sp,.dm .sp,.sl{width:30px;min-width:30px;font-size:.58rem}.fn span{width:44px;min-width:44px;font-size:.55rem}.dm .dc{width:44px;min-width:44px}.fc{width:44px;min-width:44px;height:34px}.sr{height:34px}.sn{left:30px}.nd{width:26px;height:26px;font-size:.52rem}.nd.root{width:28px;height:28px;font-size:.56rem}.lg{margin-top:10px;gap:3px}.li{padding:3px 7px;font-size:.58rem}.site-nav{padding:8px 10px}.nav-link{font-size:.68rem;padding:5px 10px}}
@media(max-width:380px){.fn span,.dm .dc,.fc{width:40px;min-width:40px}.fc{height:32px}.sr{height:32px}.nd{width:23px;height:23px;font-size:.48rem}.nd.root{width:25px;height:25px}}
@media(max-height:500px)and(orientation:landscape){.app{padding:6px 10px}header{flex-direction:row;margin-bottom:6px;gap:6px}.ctrls{display:flex;gap:5px}select{padding:4px 22px 4px 6px;font-size:13px}.sr{height:30px}.fc{height:30px}.nd{width:22px;height:22px;font-size:.48rem}.nd.root{width:24px;height:24px}}
</style>
</head>
<body>
<nav class="site-nav"><a href="index.html" class="nav-link">üé∏ Fretboard</a><a href="practice.html" class="nav-link active">üéµ Practice</a><a href="theory.html" class="nav-link">üìñ Theory</a></nav>
<div class="app">
  <header><div class="logo"><i>‚ôÆ</i><h1>Practice Tools <em>/ Á∑¥Áøí„ÉÑ„Éº„É´</em></h1></div></header>
  <div class="tabs">
    <button class="tab on" onclick="stab('ap',this)">üéµ „Çπ„Ç±„Éº„É´ÂÜçÁîü</button>
    <button class="tab" onclick="stab('cmp',this)">üîÄ „Çπ„Ç±„Éº„É´ÊØîËºÉ</button>
    <button class="tab" onclick="stab('iv',this)">üéØ „Ç§„É≥„Çø„Éº„Éê„É´</button>
  </div>
  <div class="tp on" id="tp-ap">
    <div class="ctrls" style="margin-bottom:10px">
      <div class="cg"><label>Key</label><select id="ap-k"></select></div>
      <div class="cg"><label>Scale</label><select id="ap-s"></select></div>
      <div class="cg"><label>Strings</label><select id="ap-r"><option value="6">6Âº¶</option><option value="7">7Âº¶</option></select></div>
      <div class="cg"><label>Frets</label><select id="ap-f"><option value="12">12</option><option value="15">15</option><option value="17">17</option><option value="22">22</option><option value="24" selected>24</option></select></div>
    </div>
    <div class="pbc">
      <button class="pbtn" id="ap-pb" onclick="togPlay()">‚ñ∂</button>
      <div class="tc"><span>BPM</span><input type="range" class="ts" id="ap-bpm" min="40" max="200" value="100"><span id="ap-bv">100</span></div>
      <button class="db on" id="ap-du" onclick="sdir('up')">‚Üë ‰∏äÊòá</button><button class="db" id="ap-dd" onclick="sdir('down')">‚Üì ‰∏ãÈôç</button><button class="db" id="ap-db" onclick="sdir('both')">‚Üï ÂæÄÂæ©</button>
      <div class="vc"><span>üîä</span><input type="range" class="vs" id="ap-vol" min="0" max="100" value="50"></div>
    </div>
    <div class="fbw"><div class="fn" id="ap-ft"></div><div class="fb" id="ap-fb"></div><div class="fn" id="ap-fB"></div></div>
    <div class="lg" id="ap-lg"></div>
  </div>
  <div class="tp" id="tp-cmp">
    <div class="ctrls" style="margin-bottom:10px">
      <div class="cg"><label>Key</label><select id="cmp-k"></select></div>
      <div class="cg"><label>Scale A (‚óè)</label><select id="cmp-a"></select></div>
      <div class="cg"><label>Scale B (‚óÜ)</label><select id="cmp-b"></select></div>
      <div class="cg"><label>Strings</label><select id="cmp-r"><option value="6">6Âº¶</option><option value="7">7Âº¶</option></select></div>
      <div class="cg"><label>Frets</label><select id="cmp-f"><option value="12">12</option><option value="15">15</option><option value="17">17</option><option value="22">22</option><option value="24" selected>24</option></select></div>
    </div>
    <div class="clg"><div class="ci"><div style="width:14px;height:14px;border-radius:50%;background:var(--root)"></div> Scale A„ÅÆ„Åø</div><div class="ci"><div style="width:12px;height:12px;border-radius:2px;transform:rotate(45deg);background:var(--P4)"></div> Scale B„ÅÆ„Åø</div><div class="ci"><div style="width:14px;height:14px;border-radius:50%;background:var(--P5);box-shadow:0 0 0 2px rgba(255,255,255,.5)"></div> ÂÖ±ÈÄöÈü≥</div></div>
    <div class="fbw"><div class="fn" id="cmp-ft"></div><div class="fb" id="cmp-fb"></div><div class="fn" id="cmp-fB"></div></div>
    <div id="cmp-nf" style="text-align:center;margin-top:10px;font-size:.75rem;color:var(--txd)"></div>
  </div>
  <div class="tp" id="tp-iv">
    <div class="tra">
      <p style="color:var(--txd);font-size:.82rem">2„Å§„ÅÆÈü≥„ÅÆ„Ç§„É≥„Çø„Éº„Éê„É´ÔºàÈü≥Á®ãÔºâ„ÇíÂΩì„Å¶„Çà„ÅÜ</p>
      <div class="trq" id="iv-q"></div>
      <div style="margin:8px 0"><button class="trli" onclick="rpIv()">üîä</button></div>
      <div class="trfb" id="iv-fb"></div>
      <div class="tro" id="iv-opts"></div>
      <div class="trs">„Çπ„Ç≥„Ç¢: <strong id="iv-ok">0</strong> / <span id="iv-tt">0</span><span id="iv-st" style="margin-left:12px;color:var(--root)"></span></div>
      <button class="trnx" id="iv-nx" onclick="newIv()" style="display:none">Ê¨°„ÅÆÂïèÈ°å ‚Üí</button>
    </div>
  </div>
</div>
<script>
var N=['C','C#','D','D#','E','F','F#','G','G#','A','A#','B'],FM={'C#':'D‚ô≠','D#':'E‚ô≠','F#':'G‚ô≠','G#':'A‚ô≠','A#':'B‚ô≠'};
var T6={t:[4,9,2,7,11,4],n:['E','A','D','G','B','e'],w:[2.8,2.3,1.8,1.4,1.1,.9],c:['#928880','#9c9286','#a69c90','#b0a69a','#bab0a4','#c4b8ac'],h:[82.41,110,146.83,196,246.94,329.63]};
var T7={t:[11,4,9,2,7,11,4],n:['B','E','A','D','G','B','e'],w:[3.2,2.8,2.3,1.8,1.4,1.1,.9],c:['#88807a','#928880','#9c9286','#a69c90','#b0a69a','#bab0a4','#c4b8ac'],h:[61.74,82.41,110,146.83,196,246.94,329.63]};
var FS=new Set([3,5,7,9,15,17,19,21]),FD=new Set([12,24]);
var DC={'R':'root','m2':'m2','M2':'M2','m3':'m3','M3':'M3','P4':'P4','TT':'TT','P5':'P5','m6':'m6','M6':'M6','m7':'m7','M7':'M7'};
var DJ={'R':'„É´„Éº„Éà','m2':'Áü≠2','M2':'Èï∑2','m3':'Áü≠3','M3':'Èï∑3','P4':'ÂÆåÂÖ®4','TT':'„Éà„É©„Ç§„Éà„Éº„É≥','P5':'ÂÆåÂÖ®5','m6':'Áü≠6','M6':'Èï∑6','m7':'Áü≠7','M7':'Èï∑7'};
var SC={'Major / „É°„Ç∏„É£„Éº':{i:[0,2,4,5,7,9,11],d:['R','M2','M3','P4','P5','M6','M7']},'Nat Minor / „Éä„ÉÅ„É•„É©„É´„Éû„Ç§„Éä„Éº':{i:[0,2,3,5,7,8,10],d:['R','M2','m3','P4','P5','m6','m7']},'Harm Minor / „Éè„Éº„É¢„Éã„ÉÉ„ÇØ„Éû„Ç§„Éä„Éº':{i:[0,2,3,5,7,8,11],d:['R','M2','m3','P4','P5','m6','M7']},'Mel Minor / „É°„É≠„Éá„Ç£„ÉÉ„ÇØ„Éû„Ç§„Éä„Éº':{i:[0,2,3,5,7,9,11],d:['R','M2','m3','P4','P5','M6','M7']},'Maj Penta / „É°„Ç∏„É£„Éº„Éö„É≥„Çø':{i:[0,2,4,7,9],d:['R','M2','M3','P5','M6']},'Min Penta / „Éû„Ç§„Éä„Éº„Éö„É≥„Çø':{i:[0,3,5,7,10],d:['R','m3','P4','P5','m7']},'Blues / „Éñ„É´„Éº„Çπ':{i:[0,3,5,6,7,10],d:['R','m3','P4','TT','P5','m7']},'Dorian / „Éâ„É™„Ç¢„É≥':{i:[0,2,3,5,7,9,10],d:['R','M2','m3','P4','P5','M6','m7']},'Mixolydian / „Éü„ÇØ„ÇΩ„É™„Éá„Ç£„Ç¢„É≥':{i:[0,2,4,5,7,9,10],d:['R','M2','M3','P4','P5','M6','m7']},'Phrygian / „Éï„É™„Ç∏„Ç¢„É≥':{i:[0,1,3,5,7,8,10],d:['R','m2','m3','P4','P5','m6','m7']},'Lydian / „É™„Éá„Ç£„Ç¢„É≥':{i:[0,2,4,6,7,9,11],d:['R','M2','M3','TT','P5','M6','M7']},'Locrian / „É≠„ÇØ„É™„Ç¢„É≥':{i:[0,1,3,5,6,8,10],d:['R','m2','m3','P4','TT','m6','m7']},'Whole Tone / „Éõ„Éº„É´„Éà„Éº„É≥':{i:[0,2,4,6,8,10],d:['R','M2','M3','TT','m6','m7']}};
var IVS=[{s:1,n:'m2 / Áü≠2Â∫¶'},{s:2,n:'M2 / Èï∑2Â∫¶'},{s:3,n:'m3 / Áü≠3Â∫¶'},{s:4,n:'M3 / Èï∑3Â∫¶'},{s:5,n:'P4 / ÂÆåÂÖ®4Â∫¶'},{s:6,n:'TT / „Éà„É©„Ç§„Éà„Éº„É≥'},{s:7,n:'P5 / ÂÆåÂÖ®5Â∫¶'},{s:8,n:'m6 / Áü≠6Â∫¶'},{s:9,n:'M6 / Èï∑6Â∫¶'},{s:10,n:'m7 / Áü≠7Â∫¶'},{s:11,n:'M7 / Èï∑7Â∫¶'},{s:12,n:'P8 / „Ç™„ÇØ„Çø„Éº„Éñ'}];
var NC=['var(--root)','var(--m2)','var(--M2)','var(--m3)','var(--M3)','var(--P4)','var(--TT)','var(--P5)','var(--m6)','var(--M6)','var(--m7)','var(--M7)'];
var ax=null;
function ac(){if(!ax)try{ax=new(window.AudioContext||window.webkitAudioContext)}catch(e){return null}if(ax.state==='suspended')ax.resume();return ax}
function pf(fq,v){var c=ac();if(!c)return;v=v||.2;var t=c.currentTime,m=c.createGain();m.connect(c.destination);m.gain.setValueAtTime(0,t);m.gain.linearRampToValueAtTime(v,t+.008);m.gain.exponentialRampToValueAtTime(Math.max(v*.6,.001),t+.08);m.gain.exponentialRampToValueAtTime(Math.max(v*.3,.001),t+.4);m.gain.exponentialRampToValueAtTime(.001,t+1.8);[{r:1,g:1},{r:2,g:.5},{r:3,g:.25},{r:4,g:.15},{r:5,g:.08}].forEach(function(h){var o=c.createOscillator(),g=c.createGain();o.type='triangle';o.frequency.setValueAtTime(fq*h.r,t);g.gain.setValueAtTime(h.g,t);o.connect(g);g.connect(m);o.start(t);o.stop(t+2)})}
function ps(ns,si,f,v){var T=+ns===7?T7:T6;pf(T.h[si]*Math.pow(2,f/12),v||.2)}
function bnd(d,ns,si,f,v){var tc=false;d.addEventListener('touchstart',function(e){e.preventDefault();tc=true;ps(ns,si,f,v);d.classList.add('pl');setTimeout(function(){d.classList.remove('pl')},300)},{passive:false});d.addEventListener('click',function(){if(tc){tc=false;return}ps(ns,si,f,v);d.classList.add('pl');setTimeout(function(){d.classList.remove('pl')},300)})}
function stab(id,el){document.querySelectorAll('.tab').forEach(function(t){t.classList.remove('on')});document.querySelectorAll('.tp').forEach(function(p){p.classList.remove('on')});document.getElementById('tp-'+id).classList.add('on');el.classList.add('on');if(id==='iv'&&ivT===0)newIv()}
function fk(el){N.forEach(function(n,i){var o=document.createElement('option');o.value=i;o.textContent=FM[n]?n+' / '+FM[n]:n;el.appendChild(o)})}
function fsc(el){Object.keys(SC).forEach(function(k){var o=document.createElement('option');o.value=k;o.textContent=k;el.appendChild(o)})}
function rfb(fbId,ftId,fBId,ns,key,scD,maxF,opts){
  opts=opts||{};var T=+ns===7?T7:T6,nst=+ns,map={};scD.i.forEach(function(iv,idx){map[(key+iv)%12]=scD.d[idx]});
  var mapB=null,sA=null,sB=null;
  if(opts.scB){mapB={};opts.scB.i.forEach(function(iv,idx){mapB[(key+iv)%12]=opts.scB.d[idx]});sA=new Set(scD.i.map(function(iv){return(key+iv)%12}));sB=new Set(opts.scB.i.map(function(iv){return(key+iv)%12}))}
  ;[ftId,fBId].forEach(function(id,idx){var el=document.getElementById(id);el.innerHTML='<div class="sp"></div>';for(var f=0;f<=maxF;f++){var s=document.createElement('span');s.textContent=f;if(idx===0){if(FD.has(f))s.className='hd';else if(FS.has(f))s.className='hs'}else{if(FD.has(f))s.className='ht';else if(FS.has(f))s.className='st'}el.appendChild(s)}});
  var fb=document.getElementById(fbId);fb.innerHTML='';var sh=38,th=nst*sh,my=th/2-16,d1=th*.25,d2=th*.75;
  var dm=document.createElement('div');dm.className='dm';dm.innerHTML='<div class="sp"></div>';
  for(var f=0;f<=maxF;f++){var c=document.createElement('div');c.className='dc';if(FS.has(f))c.innerHTML='<div class="d" style="top:'+my+'px"></div>';else if(FD.has(f))c.innerHTML='<div class="d" style="top:'+d1+'px"></div><div class="d" style="top:'+d2+'px"></div>';dm.appendChild(c)}
  fb.appendChild(dm);var dots=[];
  for(var si=nst-1;si>=0;si--){var row=document.createElement('div');row.className='sr';var sn=document.createElement('div');sn.className='sn';sn.style.height=T.w[si]+'px';sn.style.background=T.c[si];sn.style.opacity='.4';row.appendChild(sn);var lb=document.createElement('div');lb.className='sl';lb.textContent=T.n[si];row.appendChild(lb);
    for(var f=0;f<=maxF;f++){var cell=document.createElement('div');cell.className='fc'+(f===0?' nut':'');var ni=(T.t[si]+f)%12;
      if(mapB){var inA=sA.has(ni),inB=sB.has(ni);if(inA||inB){var dot=document.createElement('div'),nn=N[ni];if(inA&&inB){dot.className='nd P5 olap';dot.textContent=nn}else if(inA){dot.className='nd '+DC[map[ni]];dot.textContent=nn}else{dot.className='nd cmp';dot.style.background='var(--P4)';dot.style.color='#fff';dot.innerHTML='<span>'+nn+'</span>'}dot.style.animationDelay=f*10+'ms';bnd(dot,ns,si,f,.2);cell.appendChild(dot);dots.push({dot:dot,s:si,f:f,ni:ni})}}
      else if(map[ni]!==undefined){var dg=map[ni],dot=document.createElement('div');dot.className='nd '+DC[dg];dot.textContent=N[ni];dot.style.animationDelay=(Math.abs(si-Math.floor(nst/2))*15+f*10)+'ms';bnd(dot,ns,si,f,.2);cell.appendChild(dot);dots.push({dot:dot,s:si,f:f,ni:ni})}
      row.appendChild(cell)}fb.appendChild(row)}return dots}
var apOn=false,apTm=null,apDir='up',apDots=[];
function rAP(){var key=+document.getElementById('ap-k').value,scD=SC[document.getElementById('ap-s').value],ns=document.getElementById('ap-r').value,fr=+document.getElementById('ap-f').value;apDots=rfb('ap-fb','ap-ft','ap-fB',ns,key,scD,fr);var T=+ns===7?T7:T6;apDots.sort(function(a,b){return T.h[a.s]*Math.pow(2,a.f/12)-T.h[b.s]*Math.pow(2,b.f/12)});var seen={},uniq=[];apDots.forEach(function(d){var p=d.ni+Math.floor((T.t[d.s]+d.f)/12)*12;if(!seen[p]){seen[p]=1;uniq.push(d)}});apDots=uniq;var lg=document.getElementById('ap-lg');lg.innerHTML='';var sn={};scD.d.forEach(function(dg){if(sn[dg])return;sn[dg]=1;var it=document.createElement('div');it.className='li';it.innerHTML='<div class="ls" style="background:var(--'+DC[dg]+')"></div>'+dg+' '+DJ[dg];lg.appendChild(it)})}
function togPlay(){if(apOn){stopAP();return}apOn=true;document.getElementById('ap-pb').textContent='‚è∏';document.getElementById('ap-pb').classList.add('pg');playSq()}
function stopAP(){apOn=false;clearTimeout(apTm);document.getElementById('ap-pb').textContent='‚ñ∂';document.getElementById('ap-pb').classList.remove('pg')}
function playSq(){if(!apOn||!apDots.length)return;var bpm=+document.getElementById('ap-bpm').value,dl=60000/bpm,v=(+document.getElementById('ap-vol').value/100)*.3,ns=document.getElementById('ap-r').value;var sq=apDots.slice();if(apDir==='down')sq.reverse();else if(apDir==='both')sq=apDots.concat(apDots.slice().reverse().slice(1));var idx=0;(function step(){if(!apOn||idx>=sq.length){stopAP();return}var d=sq[idx];ps(ns,d.s,d.f,v);d.dot.classList.add('pl');setTimeout(function(){d.dot.classList.remove('pl')},Math.min(dl*.8,300));idx++;apTm=setTimeout(step,dl)})()}
function sdir(d){apDir=d;['up','down','both'].forEach(function(x){document.getElementById('ap-d'+x[0]).classList.toggle('on',x===d)})}
function rCMP(){var key=+document.getElementById('cmp-k').value,scA=SC[document.getElementById('cmp-a').value],scB=SC[document.getElementById('cmp-b').value],ns=document.getElementById('cmp-r').value,fr=+document.getElementById('cmp-f').value;rfb('cmp-fb','cmp-ft','cmp-fB',ns,key,scA,fr,{scB:scB});var sA=new Set(scA.i.map(function(iv){return(key+iv)%12})),sBs=new Set(scB.i.map(function(iv){return(key+iv)%12}));var com=[];sA.forEach(function(n){if(sBs.has(n))com.push(N[n])});var nA=document.getElementById('cmp-a').value.split('/')[0].trim(),nB=document.getElementById('cmp-b').value.split('/')[0].trim();document.getElementById('cmp-nf').innerHTML=N[key]+' '+nA+' vs '+nB+' ‚Äî ÂÖ±ÈÄöÈü≥: '+com.length+'/'+Math.max(sA.size,sBs.size)+' ('+com.join(', ')+')'}
var ivOk=0,ivT=0,ivSk=0,ivN1=0,ivAns=-1;
function newIv(){ivN1=Math.floor(Math.random()*12);var st=Math.floor(Math.random()*12)+1;ivAns=st;var q=document.getElementById('iv-q');q.innerHTML='<div class="trn" style="background:'+NC[ivN1]+'">'+N[ivN1]+'</div><span style="color:var(--txd);font-size:1.5rem">‚Üí</span><div class="trn" style="background:'+NC[(ivN1+st)%12]+'">'+N[(ivN1+st)%12]+'</div>';document.getElementById('iv-fb').textContent='';document.getElementById('iv-nx').style.display='none';setTimeout(rpIv,300);var opts=document.getElementById('iv-opts');opts.innerHTML='';var ch=new Set([st]);while(ch.size<4)ch.add(Math.floor(Math.random()*12)+1);var arr=[];ch.forEach(function(v){arr.push(v)});arr.sort(function(a,b){return a-b});arr.forEach(function(c){var btn=document.createElement('button');btn.className='trb';btn.textContent=IVS[c-1].n;btn.addEventListener('click',function(){chkIv(c,btn)});opts.appendChild(btn)})}
function rpIv(){var bf=261.63;pf(bf*Math.pow(2,ivN1/12),.2);setTimeout(function(){pf(bf*Math.pow(2,(ivN1+ivAns)/12),.2)},500)}
function chkIv(c,btn){ivT++;document.querySelectorAll('.trb').forEach(function(b){b.style.pointerEvents='none'});if(c===ivAns){ivOk++;ivSk++;btn.classList.add('ok');document.getElementById('iv-fb').textContent='‚úÖ Ê≠£Ëß£ÔºÅ'}else{ivSk=0;btn.classList.add('ng');document.querySelectorAll('.trb').forEach(function(b){if(b.textContent===IVS[ivAns-1].n)b.classList.add('ok')});document.getElementById('iv-fb').textContent='‚ùå Ê≠£Ëß£„ÅØ '+IVS[ivAns-1].n}document.getElementById('iv-ok').textContent=ivOk;document.getElementById('iv-tt').textContent=ivT;document.getElementById('iv-st').textContent=ivSk>=2?'üî• '+ivSk+'ÈÄ£Á∂öÔºÅ':'';document.getElementById('iv-nx').style.display='inline-block'}
;(function(){['ap-k','cmp-k'].forEach(function(id){fk(document.getElementById(id))});['ap-s','cmp-a','cmp-b'].forEach(function(id){fsc(document.getElementById(id))});document.getElementById('cmp-b').selectedIndex=4;['ap-k','ap-s','ap-r','ap-f'].forEach(function(id){document.getElementById(id).addEventListener('change',function(){stopAP();rAP()})});['cmp-k','cmp-a','cmp-b','cmp-r','cmp-f'].forEach(function(id){document.getElementById(id).addEventListener('change',rCMP)});document.getElementById('ap-bpm').addEventListener('input',function(){document.getElementById('ap-bv').textContent=this.value});rAP();rCMP()})();
</script>
</body>
</html>
